import{_ as x,r as u,e as h,k as _,c,o as m,b as k,a,f as w,g as b,h as f,v as g,t as A,l as S,m as M}from"#entry";import{u as I}from"./CT9M6TF9.js";const V={__name:"background",setup(y){const i=u(null);let r,o=[];const s=()=>{const d=i.value.getContext("2d"),l=window.innerWidth,p=window.innerHeight;i.value.width=l,i.value.height=p,o=Array.from({length:100},()=>({x:Math.random()*l,y:Math.random()*p,size:Math.random()*2+1,alpha:Math.random(),delta:Math.random()*.02+.005}));const v=()=>{d.clearRect(0,0,l,p);for(let e of o)e.alpha+=e.delta,(e.alpha>=1||e.alpha<=0)&&(e.delta*=-1),d.fillStyle=`rgba(255,255,255,${e.alpha})`,d.fillRect(e.x,e.y,e.size,e.size);r=requestAnimationFrame(v)};v()};return h(()=>{s(),window.addEventListener("resize",s)}),_(()=>{cancelAnimationFrame(r),window.removeEventListener("resize",s)}),(d,l)=>(m(),c("canvas",{ref_key:"canvas",ref:i,class:"fixed top-0 left-0 w-full h-full z-[-1]"},null,512))}},z=x(V,[["__scopeId","data-v-0cbee482"]]),L={class:"min-h-screen flex items-center justify-center"},U={class:"z-10 p-8 bg-slate-50 bg-opacity-10 backdrop-blur-md rounded-lg shadow-lg"},C={key:0,class:"w-full h-1 bg-gray-400 rounded overflow-hidden mb-4"},P={class:"text-2xl font-bold mb-6 text-center text-slate-50"},q=["disabled"],N={key:0},B={key:1},R={__name:"index",setup(y){const i=M(),r=u(""),o=u(""),s=u("admin"),d=u(!1),l=u(!1);h(async()=>{try{const e=await window.electronAPI.checkAdmin();d.value=!e}catch(e){console.error("Error checking admin:",e)}});async function p(){try{const e=await window.electronAPI.createAdmin({name:r.value,password:o.value});e&&e.success?(alert("Admin account created successfully!"),d.value=!1):alert(e?.error||"Failed to create admin.")}catch(e){console.error("Setup error:",e),alert("Something went wrong while setting up admin.")}}async function v(){l.value=!0;try{const e=await window.electronAPI.login({role:s.value,name:r.value,password:o.value});if(e&&e.success){localStorage.setItem("token","true"),localStorage.setItem("name",e.name),localStorage.setItem("role",e.role);const t=I("user");t.value={name:e.name,role:e.role},(e.role==="admin"||e.role==="cashier")&&i.push("/dashboard")}else alert(e?.error||"Login failed.")}catch(e){console.error("Login error:",e),alert("Something went wrong during login.")}finally{l.value=!1}}return(e,t)=>(m(),c("div",L,[k(z),a("div",U,[d.value?(m(),c("form",{key:0,onSubmit:b(p,["prevent"]),class:"p-8 rounded w-full max-w-sm"},[t[5]||(t[5]=a("h2",{class:"text-2xl font-bold mb-6 text-center text-slate-50"}," Setup Admin Account ",-1)),f(a("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>r.value=n),type:"text",placeholder:"Admin Name",class:"w-full p-2 border border-gray-400 rounded mb-4",required:""},null,512),[[g,r.value]]),f(a("input",{"onUpdate:modelValue":t[1]||(t[1]=n=>o.value=n),type:"password",placeholder:"Password",class:"w-full p-2 border border-gray-400 rounded mb-6",required:""},null,512),[[g,o.value]]),t[6]||(t[6]=a("button",{type:"submit",class:"w-full bg-green-500 text-slate-50 py-2 rounded hover:bg-green-600"}," Create Admin ",-1))],32)):w("",!0),a("form",{onSubmit:b(v,["prevent"]),class:"p-8 rounded w-full max-w-sm"},[l.value?(m(),c("div",C,[...t[7]||(t[7]=[a("div",{class:"h-full bg-sky-600 animate-pulse"},null,-1)])])):w("",!0),a("h2",P,A(s.value.charAt(0).toUpperCase()+s.value.slice(1))+" Login ",1),f(a("select",{"onUpdate:modelValue":t[2]||(t[2]=n=>s.value=n),class:"w-full p-2 border border-gray-400 rounded mb-4 bg-slate-50 text-slate-800"},[...t[8]||(t[8]=[a("option",{value:"admin"},"Admin",-1),a("option",{value:"cashier"},"Cashier",-1)])],512),[[S,s.value]]),f(a("input",{"onUpdate:modelValue":t[3]||(t[3]=n=>r.value=n),type:"text",placeholder:"Name",class:"w-full p-2 border border-gray-400 rounded mb-4",required:""},null,512),[[g,r.value]]),f(a("input",{"onUpdate:modelValue":t[4]||(t[4]=n=>o.value=n),type:"password",placeholder:"Password",class:"w-full p-2 border border-gray-400 rounded mb-6",required:""},null,512),[[g,o.value]]),a("button",{type:"submit",disabled:l.value,class:"w-full bg-sky-600 text-slate-50 py-2 rounded hover:bg-sky-700 disabled:bg-gray-400 disabled:cursor-not-allowed"},[l.value?(m(),c("span",B,"Processing...")):(m(),c("span",N,"Login"))],8,q)],32)])]))}};export{R as default};
