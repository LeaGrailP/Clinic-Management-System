import{r as s,A as k,e as A,c as u,a as e,f as _,g as C,h as y,v,t as b,F as P,i as D,o as c}from"./CYE6QSc-.js";const N={class:"min-h-screen bg-gray-50 dark:bg-gray-900 py-12 px-6 transition-colors duration-300"},I={class:"max-w-xl mx-auto bg-white dark:bg-gray-800 shadow-lg rounded-lg p-8 text-gray-900 dark:text-gray-100 transition-colors duration-300"},M=["disabled"],R={class:"space-y-2 max-h-96 overflow-y-auto"},V={class:"text-sm text-gray-600 dark:text-gray-300"},E=["onClick"],j={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},B={class:"bg-white dark:bg-gray-800 p-6 rounded shadow-lg w-80"},F={class:"flex justify-end gap-2"},T={__name:"register",setup(U){const o=s(""),l=s(""),p=s([]),i=s(!1),d=s(!1),n=s(""),f=s(null),x=k(()=>p.value.filter(t=>t.role!=="admin"));async function g(){try{p.value=await window.electronAPI.getAccounts()}catch(t){console.error("Failed to fetch accounts:",t)}}async function m(){if(!o.value||!l.value)return alert("Enter name & password!");i.value=!0;try{const t=await window.electronAPI["auth:register"]({name:o.value,password:l.value,role:"cashier"});t.success?(alert("✅ Cashier registered successfully!"),o.value="",l.value="",g()):alert("❌ "+t.error)}catch(t){console.error(t),alert("❌ Registration failed")}finally{i.value=!1}}function h(t){f.value=t,n.value="",d.value=!0}async function w(){if(!n.value)return alert("Enter master PIN!");try{const t=await window.electronAPI.deleteAccount({id:f.value.id,pin:n.value});t.success?(alert("Account deleted ✅"),g()):alert("❌ "+t.error)}catch(t){console.error(t),alert("❌ Deletion failed")}finally{d.value=!1}}return A(()=>{g()}),(t,r)=>(c(),u("div",N,[e("div",I,[r[4]||(r[4]=e("h2",{class:"text-2xl font-bold mb-6 text-center"},"Register New Cashier",-1)),e("form",{onSubmit:C(m,["prevent"]),class:"flex flex-col gap-4 mb-6"},[y(e("input",{"onUpdate:modelValue":r[0]||(r[0]=a=>o.value=a),type:"text",placeholder:"Name",class:"border p-2 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",required:""},null,512),[[v,o.value]]),y(e("input",{"onUpdate:modelValue":r[1]||(r[1]=a=>l.value=a),type:"password",placeholder:"Password",class:"border p-2 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",required:""},null,512),[[v,l.value]]),e("button",{type:"submit",disabled:i.value,class:"bg-sky-400 dark:bg-sky-600 text-white py-2 rounded hover:bg-sky-500 dark:hover:bg-sky-700 transition"},b(i.value?"Registering...":"Register Cashier"),9,M)],32),r[5]||(r[5]=e("h3",{class:"text-xl font-semibold mb-4"},"Accounts",-1)),e("div",R,[(c(!0),u(P,null,D(x.value,a=>(c(),u("div",{key:a.id,class:"p-3 bg-gray-100 dark:bg-gray-700 rounded flex items-center justify-between transition-colors duration-300 hover:bg-gray-200 dark:hover:bg-gray-600"},[e("div",null,[e("strong",null,b(a.name),1),e("span",V,"("+b(a.role)+")",1)]),e("button",{onClick:q=>h(a),class:"text-red-600 dark:text-red-400 hover:underline"}," Delete ",8,E)]))),128))])]),d.value?(c(),u("div",j,[e("div",B,[r[6]||(r[6]=e("h3",{class:"text-lg font-semibold mb-4 text-gray-900 dark:text-gray-100"},"Enter Master PIN",-1)),y(e("input",{"onUpdate:modelValue":r[2]||(r[2]=a=>n.value=a),type:"password",placeholder:"Master PIN",class:"w-full border p-2 rounded mb-4 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"},null,512),[[v,n.value]]),e("div",F,[e("button",{onClick:r[3]||(r[3]=a=>d.value=!1),class:"px-3 py-1 rounded bg-gray-300 dark:bg-gray-600 hover:bg-gray-400 dark:hover:bg-gray-500 transition"},"Cancel"),e("button",{onClick:w,class:"px-3 py-1 rounded bg-red-600 text-white hover:bg-red-700 transition"},"Delete")])])])):_("",!0)]))}};export{T as default};
