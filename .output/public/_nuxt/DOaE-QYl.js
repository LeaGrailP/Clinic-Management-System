import{_ as B,r as i,s as H,m as w,e as U,q as $,c as d,a as e,h as P,v as N,F as _,i as h,t as o,b as M,w as Q,j as G,d as k,x as Z,o as u}from"#entry";const J=globalThis.setInterval,X={class:"bg-slate-50 min-h-screen p-6 space-y-6"},K={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},W=["value"],Y=["value"],tt={class:"bg-sky-100 rounded-lg shadow p-6 border border-slate-400"},et={class:"flex flex-col lg:flex-row gap-6"},st={class:"flex-1 overflow-auto"},lt={class:"min-w-full border text-sm text-left"},ot=["onClick"],nt={class:"p-2 border border-slate-400"},at={class:"flex-1 overflow-auto"},rt={class:"min-w-full border border-slate-400 text-sm text-left"},it={class:"p-2 border border-slate-400"},dt={class:"p-2 border border-slate-400"},ut={class:"p-2 border border-slate-400"},ct={class:"p-2 space-x-2 flex justify-center items-center"},vt=["onClick"],pt=["onClick"],bt={class:"w-full lg:w-1/3 space-y-4"},ft={class:"bg-white p-4 rounded-lg shadow border border-gray-200 space-y-2"},yt={class:"flex justify-between"},xt={class:"text-xl"},gt={class:"flex justify-between"},mt={class:"text-xl"},wt={class:"flex justify-between"},_t={class:"text-xl"},ht={class:"flex justify-between"},kt={class:"text-xl"},Tt={class:"bg-white p-4 rounded-lg shadow border border-gray-200 space-y-2"},It={class:"flex justify-between items-center space-x-2"},At={class:"relative w-28"},St=["value"],Et={class:"flex justify-between items-center space-x-2"},Pt={class:"relative w-28"},Nt=["value"],jt={class:"flex justify-between items-center space-x-2"},Ct={class:"bg-white p-4 rounded-lg shadow border border-gray-200 space-y-2 flex justify-between"},qt={class:"text-center mb-2"},Dt={class:"flex"},Vt={class:"w-8"},Ft={class:"flex-1 break-words"},Rt={class:"w-12 text-right"},zt={class:"w-12 text-right"},Lt={class:"flex justify-between"},Ot={class:"flex justify-between"},Bt={class:"flex justify-between font-bold text-lg"},Ht={class:"flex justify-between"},Ut={class:"flex justify-between"},$t={class:"flex justify-between"},Mt={class:"flex justify-between"},Qt={class:"flex justify-between"},Gt={class:"flex justify-between"},Zt={__name:"dashboard",setup(Jt){const f=i(localStorage.getItem("name")||"Unknown User"),c=i(""),b=i(""),y=i(""),T=i([]),r=i([]),l=H({vat_sales:0,vat_amount:0,vat_exempt_sales:0,zero_rated_sales:0,discount:0,total:0}),v=i(0),j=i(null);function a(s){return new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(s||0)}function I(){const s=new Date;c.value=s.toISOString().split("T")[0],b.value=s.toTimeString().slice(0,5)}async function C(){try{T.value=await window.electron.invoke("get-products")}catch(s){console.error("Error fetching products:",s)}}async function A(){try{y.value=await window.electron.invoke("generate-invoice-number")}catch(s){console.error("Failed to fetch invoice number:",s)}}function q(s){const t=r.value.find(g=>g.id===s.id);t?(t.quantity+=1,t.total=t.quantity*t.unitPrice):r.value.push({...s,quantity:1,unitPrice:s.price||s.total,total:s.price||s.total}),p()}function D(s){const t=r.value[s];t.quantity+=1,t.total=t.quantity*t.unitPrice,p()}function V(s){const t=r.value[s];t.quantity-=1,t.quantity<=0?r.value.splice(s,1):t.total=t.quantity*t.unitPrice,p()}function p(){l.vat_sales=0,l.vat_amount=0,l.vat_exempt_sales=0,l.zero_rated_sales=0;let s=0;r.value.forEach(t=>{s+=t.total||0,l.vat_sales+=(t.vatSales||0)*(t.quantity||1),l.vat_amount+=(t.vatAmount||0)*(t.quantity||1),l.vat_exempt_sales+=(t.vatExempt||0)*(t.quantity||1),l.zero_rated_sales+=(t.zeroRated||0)*(t.quantity||1)}),l.total=Math.max(s-s*(l.discount/100),0)}function F(s){let t=parseFloat(s.target.value);(isNaN(t)||t<0)&&(t=0),t>100&&(t=100),l.discount=t,p()}const S=w(()=>r.value.reduce((s,t)=>s+t.total,0)),R=w(()=>S.value*(l.discount/100)),x=w(()=>Math.max(v.value-l.total,0));function E(){r.value=[],l.discount=0,v.value=0,p()}async function z(){if(!r.value.length)return alert("No products added!");const s={date:c.value,total:l.total,discount:l.discount,vat_sales:l.vat_sales,vat_amount:l.vat_amount,vat_exempt_sales:l.vat_exempt_sales,zero_rated_sales:l.zero_rated_sales,customer_name:f.value,items:JSON.stringify(r.value)};try{const t=await window.electron.invoke("add-invoice",s);alert(`Invoice saved! Number: ${t.invoice_number}`),E(),A()}catch(t){console.error("Failed to save invoice:",t)}}async function L(){if(!r.value.length)return alert("No products to print!");const s={header:{storeName:"FETHEA POS",address:"Pico, La Trinidad",cashier:f.value,date:`${c.value} ${b.value}`,invoiceNumber:y.value},items:r.value,totals:l,tendered:v.value,change:x.value};try{await window.electron.invoke("print-receipt",s)?console.log("Receipt printed successfully!"):alert("Printer error — please check connection.")}catch(t){console.error("Failed to print receipt:",t),alert("Failed to print receipt.")}}return U(()=>{I();const s=J(I,1e3);$(()=>clearInterval(s)),C(),A()}),(s,t)=>{const g=Z("router-link");return u(),d("div",X,[e("div",K,[e("div",null,[t[4]||(t[4]=e("label",{class:"block text-sm font-medium text-gray-700"},"Invoice Number:",-1)),e("input",{type:"text",class:"mt-1 w-full rounded-lg border-gray-300 shadow-sm focus:ring-sky-500 focus:border-sky-500",value:y.value,readonly:""},null,8,W)]),e("div",null,[t[5]||(t[5]=e("label",{class:"block text-sm font-medium text-gray-700"},"Issued By:",-1)),e("input",{type:"text",value:f.value,class:"mt-1 w-full rounded-lg border-gray-300 shadow-sm focus:ring-sky-500 focus:border-sky-500",readonly:""},null,8,Y)]),e("div",null,[t[6]||(t[6]=e("label",{class:"block text-sm font-medium text-gray-700"},"Invoice Date:",-1)),P(e("input",{type:"date",class:"mt-1 w-full rounded-lg border-gray-300 shadow-sm focus:ring-sky-500 focus:border-sky-500","onUpdate:modelValue":t[0]||(t[0]=n=>c.value=n),readonly:""},null,512),[[N,c.value]])]),e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-gray-700"},"Invoice Time:",-1)),P(e("input",{type:"time",class:"mt-1 w-full rounded-lg border-gray-300 shadow-sm focus:ring-sky-500 focus:border-sky-500","onUpdate:modelValue":t[1]||(t[1]=n=>b.value=n),readonly:""},null,512),[[N,b.value]])])]),e("div",tt,[e("div",et,[e("div",st,[e("table",lt,[t[8]||(t[8]=e("thead",{class:"bg-sky-400 text-gray-800"},[e("tr",null,[e("th",{class:"px-4 py-2 border border-slate-400"},"Product List")])],-1)),e("tbody",null,[(u(!0),d(_,null,h(T.value,n=>(u(),d("tr",{key:n.id,class:"text-center hover:bg-sky-50 cursor-pointer",onClick:m=>q(n)},[e("td",nt,o(n.productname),1)],8,ot))),128))])])]),e("div",at,[e("table",rt,[t[9]||(t[9]=e("thead",{class:"bg-sky-300 text-gray-800"},[e("tr",null,[e("th",{class:"px-4 py-2 border border-slate-400"},"Product"),e("th",{class:"px-4 py-2 border border-slate-400"},"Quantity"),e("th",{class:"px-4 py-2 border border-slate-400"},"Price"),e("th",{class:"px-4 py-2 border border-slate-400"},"Action")])],-1)),e("tbody",null,[(u(!0),d(_,null,h(r.value,(n,m)=>(u(),d("tr",{key:n.id,class:"text-center hover:bg-sky-50"},[e("td",it,o(n.productname),1),e("td",dt,o(n.quantity),1),e("td",ut,"₱"+o(n.total.toFixed(2)),1),e("td",ct,[e("button",{onClick:O=>V(m),class:"px-2 py-1 bg-sky-200 rounded hover:bg-sky-400"},"−",8,vt),e("button",{onClick:O=>D(m),class:"px-2 py-1 bg-sky-200 rounded hover:bg-sky-400"},"+",8,pt)])]))),128))])])]),e("div",bt,[e("div",ft,[e("div",yt,[t[10]||(t[10]=e("p",{class:"font-bold text-lg"},"Total VAT Sales",-1)),e("p",xt,o(a(l.vat_sales)),1)]),e("div",gt,[t[11]||(t[11]=e("p",{class:"font-bold text-lg"},"Total VAT Amount",-1)),e("p",mt,o(a(l.vat_amount)),1)]),e("div",wt,[t[12]||(t[12]=e("p",{class:"font-bold text-lg"},"Total VAT-Exempt Sales",-1)),e("p",_t,o(a(l.vat_exempt_sales)),1)]),e("div",ht,[t[13]||(t[13]=e("p",{class:"font-bold text-lg"},"Total Zero-Rated Sales",-1)),e("p",kt,o(a(l.zero_rated_sales)),1)])]),e("div",Tt,[e("div",It,[t[15]||(t[15]=e("span",{class:"font-bold"},"DISCOUNT",-1)),e("div",At,[e("input",{type:"text",value:l.discount,onInput:t[2]||(t[2]=n=>F(n)),placeholder:"0",class:"w-full text-right border rounded px-6 py-1 focus:outline-sky-500"},null,40,St),t[14]||(t[14]=e("span",{class:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500"},"%",-1))])]),e("div",Et,[t[17]||(t[17]=e("span",{class:"font-bold"},"TENDERED",-1)),e("div",Pt,[t[16]||(t[16]=e("span",{class:"absolute left-2 top-1/2 -translate-y-1/2 text-gray-500"},"₱",-1)),e("input",{type:"text",value:v.value,onInput:t[3]||(t[3]=n=>{v.value=parseFloat(n.target.value)||0,p()}),placeholder:"0.00",class:"w-full text-right border rounded px-6 py-1 focus:outline-sky-500"},null,40,Nt)])]),e("div",jt,[t[18]||(t[18]=e("span",{class:"font-bold"},"CHANGE",-1)),e("span",null,o(a(x.value)),1)])]),e("div",Ct,[t[19]||(t[19]=e("span",null,"TOTAL",-1)),e("span",null,o(a(l.total||0)),1)]),e("div",null,[M(g,{to:"/transactions",class:"text-blue-500 hover:underline"},{default:Q(()=>[...t[20]||(t[20]=[k(" View All Invoices → ",-1)])]),_:1})])])])]),e("div",{class:"grid grid-cols-1 md:grid-cols-4 gap-4"},[e("button",{onClick:z,class:"w-full bg-green-500 hover:bg-green-600 text-white py-2 px-4 rounded-lg shadow"},"Save"),e("button",{onClick:E,class:"w-full bg-red-500 hover:bg-red-600 text-white py-2 px-4 rounded-lg shadow"},"Cancel Transaction"),t[21]||(t[21]=e("button",{class:"w-full bg-gray-500 hover:bg-gray-600 text-white py-2 px-4 rounded-lg shadow"},"Open Drawer",-1)),e("button",{onClick:L,class:"w-full bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded-lg shadow"},"Print Receipt")]),e("div",{ref_key:"receipt",ref:j,class:"receipt-container p-4 font-mono hidden"},[e("div",qt,[t[22]||(t[22]=e("div",{class:"text-lg font-bold"},"FETHEA POS",-1)),t[23]||(t[23]=e("div",null,"Pico, La Trinidad",-1)),t[24]||(t[24]=e("div",null,"VAT REG TIN: 001-001-001-000",-1)),e("div",null,"CASHIER: "+o(f.value),1),e("div",null,"Date: "+o(c.value)+" "+o(b.value),1),e("div",null,"Invoice #: "+o(y.value),1)]),t[34]||(t[34]=G('<hr data-v-bd82332f><div class="flex font-bold border-b border-black pb-1 mb-1" data-v-bd82332f><span class="w-8 text-left" data-v-bd82332f>Qty</span><span class="flex-1 text-left" data-v-bd82332f>Description</span><span class="w-12 text-right" data-v-bd82332f>Price</span><span class="w-12 text-right" data-v-bd82332f>Amount</span></div>',2)),(u(!0),d(_,null,h(r.value,n=>(u(),d("div",{key:n.id,class:"mb-1"},[e("div",Dt,[e("span",Vt,o(n.quantity),1),e("span",Ft,o(n.productname),1),e("span",Rt,o(a(n.price)),1),e("span",zt,o(a(n.total)),1)])]))),128)),t[35]||(t[35]=e("hr",null,null,-1)),e("div",Lt,[t[25]||(t[25]=e("span",null,"Discount:",-1)),e("span",null,o(a(R.value)),1)]),e("div",Ot,[t[26]||(t[26]=e("span",null,"Subtotal:",-1)),e("span",null,o(a(S.value)),1)]),e("div",Bt,[t[27]||(t[27]=e("span",null,"Total:",-1)),e("span",null,o(a(l.total)),1)]),t[36]||(t[36]=e("hr",null,null,-1)),t[37]||(t[37]=e("div",{class:"flex justify-between"},[e("span",null,"Payment:"),e("span",null,"Cash")],-1)),e("div",Ht,[t[28]||(t[28]=e("span",null,"Tendered:",-1)),e("span",null,o(a(v.value)),1)]),e("div",Ut,[t[29]||(t[29]=e("span",null,"Change:",-1)),e("span",null,o(a(x.value)),1)]),t[38]||(t[38]=e("hr",null,null,-1)),e("div",$t,[t[30]||(t[30]=e("span",null,"VAT SALES:",-1)),e("span",null,o(a(l.vat_sales)),1)]),e("div",Mt,[t[31]||(t[31]=e("span",null,"12% VAT Amount:",-1)),e("span",null,o(a(l.vat_amount)),1)]),e("div",Qt,[t[32]||(t[32]=e("span",null,"VAT EXEMPT SALES:",-1)),e("span",null,o(a(l.vat_exempt_sales)),1)]),e("div",Gt,[t[33]||(t[33]=e("span",null,"ZERO RATED SALES:",-1)),e("span",null,o(a(l.zero_rated_sales)),1)]),t[39]||(t[39]=e("hr",null,null,-1)),t[40]||(t[40]=e("div",{class:"text-center text-sm mt-2"},[k(" Thank you for shopping!"),e("br"),k(" No returns without receipt. ")],-1))],512)])}}},Kt=B(Zt,[["__scopeId","data-v-bd82332f"]]);export{Kt as default};
