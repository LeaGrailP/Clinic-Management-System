import{_ as B,r,s as H,m as g,e as M,q as U,c as d,a as t,h as C,v as P,F as m,i as w,t as l,b as Q,w as $,j as G,d as _,x as Z,o as u}from"./BGyk4NGC.js";const J=window.setInterval,W={class:"bg-slate-50 min-h-screen p-6 space-y-6"},X={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},K=["value"],Y=["value"],tt={class:"bg-white rounded-lg shadow p-6 border border-gray-200"},et={class:"flex flex-col lg:flex-row gap-6"},st={class:"flex-1 overflow-auto"},lt={class:"min-w-full border border-gray-300 text-sm text-left"},ot=["onClick"],nt={class:"p-2 border"},at={class:"flex-1 overflow-auto"},it={class:"min-w-full border border-gray-300 text-sm text-left"},rt={class:"p-2 border"},dt={class:"p-2 border"},ut={class:"p-2 border"},ct={class:"p-2 border space-x-2 flex justify-center items-center"},vt=["onClick"],pt=["onClick"],ft={class:"w-full lg:w-1/3 space-y-4"},bt={class:"bg-white p-4 rounded-lg shadow border border-gray-200 space-y-2"},yt={class:"flex justify-between"},xt={class:"text-xl"},gt={class:"flex justify-between"},mt={class:"text-xl"},wt={class:"flex justify-between"},_t={class:"text-xl"},ht={class:"flex justify-between"},kt={class:"text-xl"},Tt={class:"bg-white p-4 rounded-lg shadow border border-gray-200 space-y-2"},It={class:"flex justify-between items-center space-x-2"},At={class:"relative w-28"},St=["value"],jt={class:"flex justify-between items-center space-x-2"},Et={class:"relative w-28"},Ct=["value"],Pt={class:"flex justify-between items-center space-x-2"},Nt={class:"bg-white p-4 rounded-lg shadow border border-gray-200 space-y-2 flex justify-between"},qt={class:"text-center mb-2"},Dt={class:"flex"},Vt={class:"w-8"},Rt={class:"flex-1 break-words"},Ft={class:"w-12 text-right"},Lt={class:"w-12 text-right"},zt={class:"flex justify-between"},Ot={class:"flex justify-between"},Bt={class:"flex justify-between font-bold text-lg"},Ht={class:"flex justify-between"},Mt={class:"flex justify-between"},Ut={class:"flex justify-between"},Qt={class:"flex justify-between"},$t={class:"flex justify-between"},Gt={class:"flex justify-between"},Zt={__name:"dashboard",setup(Jt){const h=r(localStorage.getItem("name")||"Unknown User"),v=r(""),f=r(""),b=r(""),k=r([]),i=r([]),o=H({vat_sales:0,vat_amount:0,vat_exempt_sales:0,zero_rated_sales:0,discount:0,total:0}),p=r(0),T=r(null);function a(s){return new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(s||0)}function I(){const s=new Date;v.value=s.toISOString().split("T")[0],f.value=s.toTimeString().slice(0,5)}async function N(){try{k.value=await window.electron.invoke("get-products")}catch(s){console.error("Error fetching products:",s)}}async function A(){try{b.value=await window.electron.invoke("generate-invoice-number")}catch(s){console.error("Failed to fetch invoice number:",s)}}function q(s){const e=i.value.find(y=>y.id===s.id);e?(e.quantity+=1,e.total=e.quantity*e.unitPrice):i.value.push({...s,quantity:1,unitPrice:s.price||s.total,total:s.price||s.total}),c()}function D(s){const e=i.value[s];e.quantity+=1,e.total=e.quantity*e.unitPrice,c()}function V(s){const e=i.value[s];e.quantity-=1,e.quantity<=0?i.value.splice(s,1):e.total=e.quantity*e.unitPrice,c()}function c(){o.vat_sales=0,o.vat_amount=0,o.vat_exempt_sales=0,o.zero_rated_sales=0;let s=0;i.value.forEach(e=>{s+=e.total||0,o.vat_sales+=(e.vatSales||0)*(e.quantity||1),o.vat_amount+=(e.vatAmount||0)*(e.quantity||1),o.vat_exempt_sales+=(e.vatExempt||0)*(e.quantity||1),o.zero_rated_sales+=(e.zeroRated||0)*(e.quantity||1)}),o.total=Math.max(s-s*(o.discount/100),0)}function R(s){let e=parseFloat(s.target.value);(isNaN(e)||e<0)&&(e=0),e>100&&(e=100),o.discount=e,c()}const S=g(()=>i.value.reduce((s,e)=>s+e.total,0)),F=g(()=>S.value*(o.discount/100)),j=g(()=>Math.max(p.value-o.total,0));function E(){i.value=[],o.discount=0,p.value=0,c()}async function L(){if(!i.value.length)return alert("No products added!");const s={date:v.value,total:o.total,items:JSON.stringify(i.value)};try{const e=await window.electron.invoke("add-invoice",s);alert(`Invoice saved! Number: ${e.invoice_number}`),E(),A()}catch(e){console.error("Failed to save invoice:",e)}}function z(){const s=window.open("","","width=300,height=600");s.document.write("<html><head><title>Receipt</title><style>"),s.document.write(`
    body { font-family: monospace; font-size: 12px; }
    .flex { display: flex; justify-content: space-between; }
    .truncate { overflow: hidden; white-space: nowrap; text-overflow: ellipsis; }
    hr { border: none; border-top: 1px dashed black; margin: 2px 0; }
  `),s.document.write("</style></head><body>"),s.document.write(T.value.innerHTML),s.document.write("</body></html>"),s.document.close(),s.print()}return M(()=>{I();const s=J(I,1e3);U(()=>clearInterval(s)),N(),A()}),(s,e)=>{const y=Z("router-link");return u(),d("div",W,[t("div",X,[t("div",null,[e[4]||(e[4]=t("label",{class:"block text-sm font-medium text-gray-700"},"Invoice #",-1)),t("input",{type:"text",class:"mt-1 w-full rounded-lg border-gray-300 shadow-sm focus:ring-sky-500 focus:border-sky-500",value:b.value,readonly:""},null,8,K)]),t("div",null,[e[5]||(e[5]=t("label",{class:"block text-sm font-medium text-gray-700"},"Issued By",-1)),t("input",{type:"text",value:h.value,class:"mt-1 w-full rounded-lg border-gray-300 shadow-sm focus:ring-sky-500 focus:border-sky-500",readonly:""},null,8,Y)]),t("div",null,[e[6]||(e[6]=t("label",{class:"block text-sm font-medium text-gray-700"},"Invoice Date",-1)),C(t("input",{type:"date",class:"mt-1 w-full rounded-lg border-gray-300 shadow-sm focus:ring-sky-500 focus:border-sky-500","onUpdate:modelValue":e[0]||(e[0]=n=>v.value=n),readonly:""},null,512),[[P,v.value]])]),t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-gray-700"},"Invoice Time",-1)),C(t("input",{type:"time",class:"mt-1 w-full rounded-lg border-gray-300 shadow-sm focus:ring-sky-500 focus:border-sky-500","onUpdate:modelValue":e[1]||(e[1]=n=>f.value=n),readonly:""},null,512),[[P,f.value]])])]),t("div",tt,[t("div",et,[t("div",st,[t("table",lt,[e[8]||(e[8]=t("thead",{class:"bg-sky-300 text-gray-800"},[t("tr",null,[t("th",{class:"px-4 py-2 border"},"Product List")])],-1)),t("tbody",null,[(u(!0),d(m,null,w(k.value,n=>(u(),d("tr",{key:n.id,class:"text-center hover:bg-gray-50 cursor-pointer",onClick:x=>q(n)},[t("td",nt,l(n.productname),1)],8,ot))),128))])])]),t("div",at,[t("table",it,[e[9]||(e[9]=t("thead",{class:"bg-sky-300 text-gray-800"},[t("tr",null,[t("th",{class:"px-4 py-2 border"},"Product"),t("th",{class:"px-4 py-2 border"},"Quantity"),t("th",{class:"px-4 py-2 border"},"Price"),t("th",{class:"px-4 py-2 border"},"Action")])],-1)),t("tbody",null,[(u(!0),d(m,null,w(i.value,(n,x)=>(u(),d("tr",{key:n.id,class:"text-center hover:bg-gray-50"},[t("td",rt,l(n.productname),1),t("td",dt,l(n.quantity),1),t("td",ut,"₱"+l(n.total.toFixed(2)),1),t("td",ct,[t("button",{onClick:O=>V(x),class:"px-2 py-1 bg-gray-200 rounded hover:bg-gray-300"},"−",8,vt),t("button",{onClick:O=>D(x),class:"px-2 py-1 bg-gray-200 rounded hover:bg-gray-300"},"+",8,pt)])]))),128))])])]),t("div",ft,[t("div",bt,[t("div",yt,[e[10]||(e[10]=t("p",{class:"font-bold text-lg"},"Total VAT Sales",-1)),t("p",xt,l(a(o.vat_sales)),1)]),t("div",gt,[e[11]||(e[11]=t("p",{class:"font-bold text-lg"},"Total VAT Amount",-1)),t("p",mt,l(a(o.vat_amount)),1)]),t("div",wt,[e[12]||(e[12]=t("p",{class:"font-bold text-lg"},"Total VAT-Exempt Sales",-1)),t("p",_t,l(a(o.vat_exempt_sales)),1)]),t("div",ht,[e[13]||(e[13]=t("p",{class:"font-bold text-lg"},"Total Zero-Rated Sales",-1)),t("p",kt,l(a(o.zero_rated_sales)),1)])]),t("div",Tt,[t("div",It,[e[15]||(e[15]=t("span",{class:"font-bold"},"DISCOUNT",-1)),t("div",At,[t("input",{type:"text",value:o.discount,onInput:e[2]||(e[2]=n=>R(n)),placeholder:"0",class:"w-full text-right border rounded px-6 py-1 focus:outline-sky-500"},null,40,St),e[14]||(e[14]=t("span",{class:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500"},"%",-1))])]),t("div",jt,[e[17]||(e[17]=t("span",{class:"font-bold"},"TENDERED",-1)),t("div",Et,[e[16]||(e[16]=t("span",{class:"absolute left-2 top-1/2 -translate-y-1/2 text-gray-500"},"₱",-1)),t("input",{type:"text",value:p.value,onInput:e[3]||(e[3]=n=>{p.value=parseFloat(n.target.value)||0,c()}),placeholder:"0.00",class:"w-full text-right border rounded px-6 py-1 focus:outline-sky-500"},null,40,Ct)])]),t("div",Pt,[e[18]||(e[18]=t("span",{class:"font-bold"},"CHANGE",-1)),t("span",null,l(a(j.value)),1)])]),t("div",Nt,[e[19]||(e[19]=t("span",null,"TOTAL",-1)),t("span",null,l(a(o.total||0)),1)]),t("div",null,[Q(y,{to:"/transactions",class:"text-blue-500 hover:underline"},{default:$(()=>e[20]||(e[20]=[_(" View All Invoices → ",-1)])),_:1,__:[20]})])])])]),t("div",{class:"grid grid-cols-1 md:grid-cols-4 gap-4"},[t("button",{onClick:L,class:"w-full bg-green-500 hover:bg-green-600 text-white py-2 px-4 rounded-lg shadow"},"Save"),t("button",{onClick:E,class:"w-full bg-red-500 hover:bg-red-600 text-white py-2 px-4 rounded-lg shadow"},"Cancel Transaction"),e[21]||(e[21]=t("button",{class:"w-full bg-gray-500 hover:bg-gray-600 text-white py-2 px-4 rounded-lg shadow"},"Open Drawer",-1)),t("button",{onClick:z,class:"w-full bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded-lg shadow"},"Print Receipt")]),t("div",{ref_key:"receipt",ref:T,class:"receipt-container p-4 font-mono hidden"},[t("div",qt,[e[22]||(e[22]=t("div",{class:"text-lg font-bold"},"FETHEA POS",-1)),e[23]||(e[23]=t("div",null,"Pico, La Trinidad",-1)),e[24]||(e[24]=t("div",null,"VAT REG TIN: 001-001-001-000",-1)),t("div",null,"CASHIER: "+l(h.value),1),t("div",null,"Date: "+l(v.value)+" "+l(f.value),1),t("div",null,"Invoice #: "+l(b.value),1)]),e[34]||(e[34]=G('<hr data-v-366fb1e3><div class="flex font-bold border-b border-black pb-1 mb-1" data-v-366fb1e3><span class="w-8 text-left" data-v-366fb1e3>Qty</span><span class="flex-1 text-left" data-v-366fb1e3>Description</span><span class="w-12 text-right" data-v-366fb1e3>Price</span><span class="w-12 text-right" data-v-366fb1e3>Amount</span></div>',2)),(u(!0),d(m,null,w(i.value,n=>(u(),d("div",{key:n.id,class:"mb-1"},[t("div",Dt,[t("span",Vt,l(n.quantity),1),t("span",Rt,l(n.productname),1),t("span",Ft,l(a(n.price)),1),t("span",Lt,l(a(n.total)),1)])]))),128)),e[35]||(e[35]=t("hr",null,null,-1)),t("div",zt,[e[25]||(e[25]=t("span",null,"Discount:",-1)),t("span",null,l(a(F.value)),1)]),t("div",Ot,[e[26]||(e[26]=t("span",null,"Subtotal:",-1)),t("span",null,l(a(S.value)),1)]),t("div",Bt,[e[27]||(e[27]=t("span",null,"Total:",-1)),t("span",null,l(a(o.total)),1)]),e[36]||(e[36]=t("hr",null,null,-1)),e[37]||(e[37]=t("div",{class:"flex justify-between"},[t("span",null,"Payment:"),t("span",null,"Cash")],-1)),t("div",Ht,[e[28]||(e[28]=t("span",null,"Tendered:",-1)),t("span",null,l(a(p.value)),1)]),t("div",Mt,[e[29]||(e[29]=t("span",null,"Change:",-1)),t("span",null,l(a(j.value)),1)]),e[38]||(e[38]=t("hr",null,null,-1)),t("div",Ut,[e[30]||(e[30]=t("span",null,"VAT SALES:",-1)),t("span",null,l(a(o.vat_sales)),1)]),t("div",Qt,[e[31]||(e[31]=t("span",null,"12% VAT Amount:",-1)),t("span",null,l(a(o.vat_amount)),1)]),t("div",$t,[e[32]||(e[32]=t("span",null,"VAT EXEMPT SALES:",-1)),t("span",null,l(a(o.vat_exempt_sales)),1)]),t("div",Gt,[e[33]||(e[33]=t("span",null,"ZERO RATED SALES:",-1)),t("span",null,l(a(o.zero_rated_sales)),1)]),e[39]||(e[39]=t("hr",null,null,-1)),e[40]||(e[40]=t("div",{class:"text-center text-sm mt-2"},[_(" Thank you for shopping!"),t("br"),_(" No returns without receipt. ")],-1))],512)])}}},Xt=B(Zt,[["__scopeId","data-v-366fb1e3"]]);export{Xt as default};
