import{r as _,A as w,e as D,c,a as t,h as v,v as f,F as b,i as F,o as u,t as a,d as T}from"./DvKMKNmD.js";const A={class:"border-slate-200 dark:border-slate-700 text-slate-800 dark:text-slate-100"},V={class:"flex gap-4 items-end mb-4"},S={class:"bg-slate-50 dark:bg-slate-600 border-slate-200 dark:border-slate-700 text-slate-800 dark:text-slate-100 p-4 rounded shadow mb-6 space-y-6"},C={class:"min-w-full border-collapse"},P={class:"px-4 py-2 border"},N={class:"px-4 py-2 border"},I={class:"px-4 py-2 border"},R={class:"font-medium"},U={class:"text-xs text-gray-600 dark:text-gray-300"},L={class:"px-4 py-2 border"},j={class:"px-4 py-2 border"},z={class:"px-4 py-2 border"},B={class:"px-4 py-2 border"},E={class:"px-4 py-2 border"},H={class:"px-4 py-2 border"},Z={__name:"transactions",setup(M){const x=_([]),d=_(""),n=_("");function l(o){return new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(o||0)}const m=w(()=>x.value.filter(o=>{const s=new Date(o.date),e=d.value?new Date(d.value):null,p=n.value?new Date(n.value):null;return!(e&&s<e||p&&s>p)}));function h(){d.value="",n.value=""}function k(){const o=["Invoice #","Date","Customer","VAT Sales","VAT Amount","VAT-Exempt Sales","Zero-Rated Sales","Discount","Total"],s=m.value.map(r=>[r.invoice_number,r.date,r.customer_name,r.vat_sales,r.vat_amount,r.vat_exempt_sales,r.zero_rated_sales,r.discount,r.total]),e=[o,...s].map(r=>r.join(",")).join(`
`),p=new Blob([e],{type:"text/csv;charset=utf-8;"}),y=URL.createObjectURL(p),i=document.createElement("a");i.href=y,i.download=`invoices_${Date.now()}.csv`,i.click(),URL.revokeObjectURL(y)}async function g(){try{const o=m.value.map(e=>({id:e.id,invoice_number:e.invoice_number,date:e.date,customer_name:e.customer_name,vat_sales:e.vat_sales,vat_amount:e.vat_amount,vat_exempt_sales:e.vat_exempt_sales,zero_rated_sales:e.zero_rated_sales,discount:e.discount,total:e.total})),s=await window.electron.invoke("export-invoices-pdf",o);alert(`PDF saved at: ${s}`)}catch(o){console.error("Failed to save PDF:",o),alert("Failed to generate PDF")}}return D(async()=>{try{x.value=await window.electron.invoke("get-all-invoices")}catch(o){console.error("Failed to fetch invoices:",o)}}),(o,s)=>(u(),c("div",A,[t("div",V,[t("div",null,[s[2]||(s[2]=t("label",{class:"block text-sm font-medium"},"From",-1)),v(t("input",{type:"date","onUpdate:modelValue":s[0]||(s[0]=e=>d.value=e),class:"mt-1 border rounded px-2 py-1 bg-slate-50 dark:bg-slate-800 text-slate-800 dark:text-slate-100"},null,512),[[f,d.value]])]),t("div",null,[s[3]||(s[3]=t("label",{class:"block text-sm font-medium"},"To",-1)),v(t("input",{type:"date","onUpdate:modelValue":s[1]||(s[1]=e=>n.value=e),class:"mt-1 border rounded px-2 py-1 bg-slate-50 dark:bg-slate-800 text-slate-800 dark:text-slate-100"},null,512),[[f,n.value]])]),t("button",{onClick:h,class:"px-4 py-2 bg-gray-400 rounded"},"Clear"),t("button",{onClick:k,class:"px-4 py-2 bg-sky-400 text-white rounded"},"Save as CSV"),t("button",{onClick:g,class:"px-4 py-2 bg-orange-400 text-white rounded"},"Save as PDF")]),t("div",S,[t("table",C,[s[4]||(s[4]=t("thead",{class:"bg-slate-400"},[t("tr",null,[t("th",{class:"px-4 py-2 border"},"Invoice #"),t("th",{class:"px-4 py-2 border"},"Date"),t("th",{class:"px-4 py-2 border"},"Customer"),t("th",{class:"px-4 py-2 border"},"VAT Sales"),t("th",{class:"px-4 py-2 border"},"VAT Amount"),t("th",{class:"px-4 py-2 border"},"VAT-Exempt Sales"),t("th",{class:"px-4 py-2 border"},"Zero-Rated Sales"),t("th",{class:"px-4 py-2 border"},"Discount"),t("th",{class:"px-4 py-2 border"},"Total")])],-1)),t("tbody",null,[(u(!0),c(b,null,F(m.value,e=>(u(),c("tr",{key:e.id},[t("td",P,a(e.invoice_number),1),t("td",N,a(e.date),1),t("td",I,[e.patient_id?(u(),c(b,{key:0},[t("div",R,a(e.lastName)+", "+a(e.firstName)+" "+a(e.middleName),1),t("div",U," TIN: "+a(e.patient_tin),1)],64)):(u(),c(b,{key:1},[T(a(e.customer_name),1)],64))]),t("td",L,a(l(e.vat_sales)),1),t("td",j,a(l(e.vat_amount)),1),t("td",z,a(l(e.vat_exempt_sales)),1),t("td",B,a(l(e.zero_rated_sales)),1),t("td",E,a(l(e.discount)),1),t("td",H,a(l(e.total)),1)]))),128))])])])]))}};export{Z as default};
