import{_ as z,r as i,e as V,k as N,c as f,o as p,b as E,a as t,f as R,F as x,g as b,h as g,v as y,l as k,m as A,n as h,p as B,q as $,t as P,s as D}from"./DutVACua.js";import{u as j}from"./Bx14vtBC.js";import{c as C}from"./DFW2IHCG.js";const q={__name:"background",setup(I){const w=i(null);let n,d=[];const v=()=>{const s=w.value.getContext("2d"),u=window.innerWidth,c=window.innerHeight;w.value.width=u,w.value.height=c,d=Array.from({length:100},()=>({x:Math.random()*u,y:Math.random()*c,size:Math.random()*2+1,alpha:Math.random(),delta:Math.random()*.02+.005}));const m=()=>{s.clearRect(0,0,u,c);for(let l of d)l.alpha+=l.delta,(l.alpha>=1||l.alpha<=0)&&(l.delta*=-1),s.fillStyle=`rgba(255,255,255,${l.alpha})`,s.fillRect(l.x,l.y,l.size,l.size);n=requestAnimationFrame(m)};m()};return V(()=>{v(),window.addEventListener("resize",v)}),N(()=>{cancelAnimationFrame(n),window.removeEventListener("resize",v)}),(s,u)=>(p(),f("canvas",{ref_key:"canvas",ref:w,class:"fixed top-0 left-0 w-full h-full z-[-1]"},null,512))}},H=z(q,[["__scopeId","data-v-0cbee482"]]);const M=C("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);const S=C("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),O={class:"min-h-screen flex items-center justify-center relative"},T={class:"z-10 p-8 bg-white/10 backdrop-blur-lg rounded-xl shadow-2xl w-[380px]"},W={key:0,class:"text-white text-center text-lg py-4"},G={class:"relative"},J=["type"],K={class:"relative"},Q=["type"],X=["disabled"],Y=["disabled"],ae={__name:"index",setup(I){const w=D(),n=i(""),d=i(""),v=i("admin"),s=i(!1),u=i(""),c=i(""),m=i(!1),l=i(!1),r=i("checking");V(async()=>{try{const a=await window.electronAPI.checkAdmin();r.value=a?"login":"setup"}catch(a){console.error(a),r.value="setup"}});function L(){n.value="",d.value=""}async function _(){try{const a=await window.electronAPI.createAdmin({name:n.value,password:d.value});a?.success?(alert("Admin account created!"),L(),r.value="login"):alert(a?.error||"Failed to create admin.")}catch(a){console.error(a)}}async function F(){l.value=!0;try{const a=await window.electronAPI.login({role:v.value,name:n.value,password:d.value});if(a?.success){localStorage.setItem("token","true"),localStorage.setItem("name",a.name),localStorage.setItem("role",a.role);const e=j("user");e.value={name:a.name,role:a.role},w.push("/dashboard")}else alert(a?.error||"Login failed.")}catch(a){console.error(a)}finally{l.value=!1}}async function U(){m.value=!0;try{const a=await window.electronAPI.resetPassword({name:u.value,newPassword:c.value});a?.success?(alert("Password updated!"),r.value="login",u.value="",c.value=""):alert(a?.error||"Reset failed.")}catch(a){console.error(a)}finally{m.value=!1}}return(a,e)=>(p(),f("div",O,[E(H),t("div",T,[r.value==="checking"?(p(),f("div",W,"Loading...")):r.value==="setup"?(p(),f(x,{key:1},[e[11]||(e[11]=t("h2",{class:"text-2xl font-semibold text-center text-white mb-6"}," Setup Admin Account ",-1)),t("form",{onSubmit:b(_,["prevent"]),class:"space-y-4"},[g(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>n.value=o),type:"text",placeholder:"Admin Name",class:"w-full p-3 rounded bg-white/80 text-gray-900"},null,512),[[y,n.value]]),t("div",G,[t("input",{type:s.value?"text":"password",placeholder:"Enter password",class:"border px-3 py-2 rounded w-full"},null,8,J),t("button",{type:"button",onClick:e[1]||(e[1]=o=>s.value=!s.value),class:"absolute right-3 top-1/2 -translate-y-1/2"},[(p(),k(A(s.value?h(M):h(S)),{class:"w-5 h-5 text-black"}))])]),e[10]||(e[10]=t("button",{class:"w-full bg-green-500 text-white py-2 rounded hover:bg-green-600"}," Create Admin ",-1))],32)],64)):r.value==="login"?(p(),f(x,{key:2},[e[13]||(e[13]=t("h2",{class:"text-2xl font-semibold text-center text-white mb-6"}," Login ",-1)),t("form",{onSubmit:b(F,["prevent"]),class:"space-y-4"},[g(t("select",{"onUpdate:modelValue":e[2]||(e[2]=o=>v.value=o),class:"w-full p-3 rounded bg-white/80 text-gray-900"},[...e[12]||(e[12]=[t("option",{value:"admin"},"Admin",-1),t("option",{value:"cashier"},"Cashier",-1)])],512),[[B,v.value]]),g(t("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>n.value=o),type:"text",placeholder:"Name",class:"w-full p-3 rounded bg-white/80 text-gray-900"},null,512),[[y,n.value]]),t("div",K,[g(t("input",{type:s.value?"text":"password","onUpdate:modelValue":e[4]||(e[4]=o=>d.value=o),placeholder:"Password",class:"w-full p-3 rounded bg-white/80 text-gray-900"},null,8,Q),[[$,d.value]]),t("button",{type:"button",onClick:e[5]||(e[5]=o=>s.value=!s.value),class:"absolute right-3 top-1/2 -translate-y-1/2"},[(p(),k(A(s.value?h(M):h(S)),{class:"w-5 h-5 text-black"}))])]),t("button",{disabled:l.value,class:"w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700 disabled:bg-gray-400"},P(l.value?"Processing...":"Login"),9,X),t("p",{class:"text-center text-white underline cursor-pointer",onClick:e[6]||(e[6]=o=>r.value="forgot")}," Forgot Password? ")],32)],64)):r.value==="forgot"?(p(),f(x,{key:3},[e[14]||(e[14]=t("h2",{class:"text-2xl font-semibold text-center text-white mb-6"}," Reset Password ",-1)),t("form",{onSubmit:b(U,["prevent"]),class:"space-y-4"},[g(t("input",{"onUpdate:modelValue":e[7]||(e[7]=o=>u.value=o),type:"text",placeholder:"Existing Username",class:"w-full p-3 rounded bg-white/80 text-gray-900"},null,512),[[y,u.value]]),g(t("input",{"onUpdate:modelValue":e[8]||(e[8]=o=>c.value=o),type:"password",placeholder:"New Password",class:"w-full p-3 rounded bg-white/80 text-gray-900"},null,512),[[y,c.value]]),t("button",{disabled:m.value,class:"w-full bg-purple-600 text-white py-2 rounded hover:bg-purple-700 disabled:bg-gray-400"},P(m.value?"Updating...":"Reset Password"),9,Y),t("p",{class:"text-center text-white underline cursor-pointer",onClick:e[9]||(e[9]=o=>r.value="login")}," Back to Login ")],32)],64)):R("",!0)])]))}};export{ae as default};
