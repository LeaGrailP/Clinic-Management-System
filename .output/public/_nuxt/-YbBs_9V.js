import{r as o,e as _,c as n,a as t,g as A,h as f,v as p,t as b,F as N,i as C,o as l}from"./HKRDA1XH.js";const P={class:"min-h-screen bg-gray-50 dark:bg-gray-900 py-12 px-6 transition-colors duration-300"},F={class:"max-w-xl mx-auto bg-white dark:bg-gray-800 shadow-lg rounded-lg p-8 text-gray-900 dark:text-gray-100 transition-colors duration-300"},I=["disabled"],E={class:"space-y-2 max-h-96 overflow-y-auto"},R={class:"flex-1"},U={key:0},V={class:"text-sm text-gray-600 dark:text-gray-300"},D={key:1,class:"flex gap-2"},B={class:"flex gap-2"},M=["onClick"],S=["onClick"],j={__name:"profile",setup(q){const d=o(""),u=o(""),k=o([]),y=o(!1),c=o(null),s=o(""),i=o("");async function v(){try{k.value=await window.electronAPI.getAccounts()}catch(r){console.error("Failed to fetch accounts:",r)}}async function w(){if(!d.value||!u.value)return alert("Enter name & password!");y.value=!0;try{const r=await window.electronAPI["auth:register"]({name:d.value,password:u.value,role:"cashier"});r.success?(alert("✅ Cashier registered successfully!"),d.value="",u.value="",v()):alert("❌ "+r.error)}catch(r){console.error(r),alert("❌ Registration failed")}finally{y.value=!1}}function x(r){c.value=r.id,s.value=r.name,i.value=""}async function h(){if(!s.value)return alert("Name cannot be empty!");try{const r=k.value.find(e=>e.id===c.value).name;if(s.value!==r&&!(await window.electronAPI["user:updateName"]({oldName:r,newName:s.value})).success)return alert("Failed to update name");if(i.value&&!(await window.electronAPI["auth:register"]({name:s.value,password:i.value,role:"cashier"})).success)return alert("Failed to update password");c.value=null,s.value="",i.value="",v()}catch(r){console.error(r),alert("❌ Update failed")}}async function m(r){if(confirm("Are you sure you want to delete this account?"))try{(await window.electronAPI.deleteAccount(r)).success?(alert("Account deleted ✅"),v()):alert("Failed to delete account")}catch(e){console.error(e),alert("❌ Deletion failed")}}return _(()=>{v()}),(r,e)=>(l(),n("div",P,[t("div",F,[e[4]||(e[4]=t("h2",{class:"text-2xl font-bold mb-6 text-center"},"Register New Cashier",-1)),t("form",{onSubmit:A(w,["prevent"]),class:"flex flex-col gap-4 mb-6"},[f(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>d.value=a),type:"text",placeholder:"Name",class:"border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 p-2 rounded focus:outline-none focus:ring-2 focus:ring-sky-400 dark:focus:ring-sky-600 transition",required:""},null,512),[[p,d.value]]),f(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>u.value=a),type:"password",placeholder:"Password",class:"border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 p-2 rounded focus:outline-none focus:ring-2 focus:ring-sky-400 dark:focus:ring-sky-600 transition",required:""},null,512),[[p,u.value]]),t("button",{type:"submit",disabled:y.value,class:"bg-sky-400 dark:bg-sky-600 text-white py-2 rounded hover:bg-sky-500 dark:hover:bg-sky-700 transition"},b(y.value?"Registering...":"Register Cashier"),9,I)],32),e[5]||(e[5]=t("h3",{class:"text-xl font-semibold mb-4"},"Accounts",-1)),t("div",E,[(l(!0),n(N,null,C(k.value,a=>(l(),n("div",{key:a.id,class:"p-3 bg-gray-100 dark:bg-gray-700 rounded flex items-center justify-between transition-colors duration-300 hover:bg-gray-200 dark:hover:bg-gray-600"},[t("div",R,[c.value!==a.id?(l(),n("div",U,[t("strong",null,b(a.name),1),t("span",V,"("+b(a.role)+")",1)])):(l(),n("div",D,[f(t("input",{"onUpdate:modelValue":e[2]||(e[2]=g=>s.value=g),type:"text",placeholder:"New Name",class:"border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 p-1 rounded w-24 focus:outline-none focus:ring-2 focus:ring-sky-400 dark:focus:ring-sky-600 transition"},null,512),[[p,s.value]]),f(t("input",{"onUpdate:modelValue":e[3]||(e[3]=g=>i.value=g),type:"password",placeholder:"New Password",class:"border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 p-1 rounded w-28 focus:outline-none focus:ring-2 focus:ring-sky-400 dark:focus:ring-sky-600 transition"},null,512),[[p,i.value]])]))]),t("div",B,[c.value!==a.id?(l(),n("button",{key:0,onClick:g=>x(a),class:"text-blue-600 dark:text-blue-400 hover:underline"}," Edit ",8,M)):(l(),n("button",{key:1,onClick:h,class:"text-green-600 dark:text-green-400 hover:underline"}," Save ")),t("button",{onClick:g=>m(a.id),class:"text-red-600 dark:text-red-400 hover:underline"}," Delete ",8,S)])]))),128))])])]))}};export{j as default};
